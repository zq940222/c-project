import{M as U}from"./MonacoEditor-BkwIVYFS.js";import{d as q,r as k,c as S,_ as J,a as C,b as n,w as e,e as r,o as i,u as o,f as u,g,F as L,t as c,h as Q,i as z,j as v}from"./index-DIi-ZwBs.js";import{p as X,r as Y}from"./index-CEDoj4eB.js";const Z=q("editor",()=>{const p=k(""),t=k("example.c"),m=k(null),d=k(null),_=k(!1),w=S(()=>{var a;return(a=d.value)!=null&&a.results?d.value.results:[]}),x=S(()=>{var a;return((a=d.value)==null?void 0:a.summary)||{errorCount:0,warningCount:0,passCount:0}});async function h(){if(p.value.trim()){_.value=!0;try{const a=await X.parseContent(p.value,t.value);a.code===200&&(m.value=a.data)}catch(a){console.error("解析失败:",a)}finally{_.value=!1}}}async function T(a=null){if(p.value.trim()){_.value=!0;try{const l=await Y.execute(a,p.value,t.value);l.code===200&&(d.value=l.data)}catch(l){console.error("检查失败:",l)}finally{_.value=!1}}}function I(a){p.value=a}function A(){m.value=null,d.value=null}return{content:p,fileName:t,parseResult:m,checkResult:d,loading:_,problems:w,summary:x,parseContent:h,executeCheck:T,setContent:I,clearResults:A}}),$={class:"editor-view"},ee={key:0},te=`// C语言数据文件示例
#define WHITE 白色
#define BLACK 黑色

// 定义猫的结构体
struct 猫 {
    char* ID;
    char* 名字;
    char* 品种;
    int 出生日期;
    char* 颜色;
};

// 园区的猫数据
猫 园区的猫们[] = {
    {"CAT001", "小黄", "橘猫", 2023, "黄色"},
    {"CAT002", "小黑", "狸花", 2024, "灰色"},
    {"CAT001", "大黄", "橘猫", 2022, "黄色"},
    {"CAT003", "小白", "波斯", 1985, "白色"},
    {"CAT004", "花花", "狸花", 2023, "花色"},
    {"CAT005", "咪咪", "暹罗", 2024, "紫色"}
};
`,ae={__name:"EditorView",setup(p){const t=Z(),m=k(null),d=[{title:"字段名",dataIndex:"name",key:"name"},{title:"类型",dataIndex:"type",key:"type"},{title:"指针",dataIndex:"isPointer",key:"isPointer",customRender:({text:a})=>a?"是":"否"}],_=[{title:"类型",dataIndex:"resultType",key:"resultType",width:80},{title:"规则",dataIndex:"ruleName",key:"ruleName",width:150},{title:"位置",key:"location",width:100},{title:"消息",dataIndex:"message",key:"message"}],w=S(()=>t.problems.map(a=>{var l;return{type:a.resultType,message:a.message,line:((l=a.location)==null?void 0:l.startLine)||1}}));function x(){t.setContent(te),t.clearResults(),v.success("已加载示例代码")}async function h(){if(!t.content.trim()){v.warning("请先输入代码");return}await t.parseContent(),v.success("解析完成")}async function T(){if(!t.content.trim()){v.warning("请先输入代码");return}await t.executeCheck(),v.success("检查完成")}function I(a){switch(a){case"ERROR":return"red";case"WARNING":return"orange";case"INFO":return"blue";default:return"green"}}function A(a){a.location&&m.value&&m.value.revealLine(a.location.startLine)}return(a,l)=>{const N=r("a-button"),B=r("a-space"),V=r("a-card"),D=r("a-col"),b=r("a-descriptions-item"),M=r("a-descriptions"),F=r("a-divider"),P=r("a-table"),O=r("a-collapse-panel"),W=r("a-collapse"),E=r("a-empty"),j=r("a-list-item-meta"),G=r("a-list-item"),H=r("a-list"),K=r("a-row"),R=r("a-tag");return i(),C("div",$,[n(K,{gutter:16},{default:e(()=>[n(D,{span:16},{default:e(()=>[n(V,{title:"代码编辑器",bordered:!1},{extra:e(()=>[n(B,null,{default:e(()=>[n(N,{onClick:x},{default:e(()=>[...l[1]||(l[1]=[u("加载示例",-1)])]),_:1}),n(N,{type:"primary",onClick:h,loading:o(t).loading},{default:e(()=>[...l[2]||(l[2]=[u(" 解析 ",-1)])]),_:1},8,["loading"]),n(N,{type:"primary",onClick:T,loading:o(t).loading},{default:e(()=>[...l[3]||(l[3]=[u(" 规则检查 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:e(()=>[n(U,{ref_key:"editorRef",ref:m,modelValue:o(t).content,"onUpdate:modelValue":l[0]||(l[0]=f=>o(t).content=f),language:"c",height:"500px",markers:w.value},null,8,["modelValue","markers"])]),_:1})]),_:1}),n(D,{span:8},{default:e(()=>[n(V,{title:"解析结果",bordered:!1,style:{"margin-bottom":"16px"}},{default:e(()=>{var f,y;return[o(t).parseResult?(i(),C(L,{key:0},[n(M,{column:1,size:"small"},{default:e(()=>[n(b,{label:"文件ID"},{default:e(()=>[u(c(o(t).parseResult.fileId),1)]),_:1}),n(b,{label:"结构体"},{default:e(()=>{var s;return[u(c(((s=o(t).parseResult.structs)==null?void 0:s.length)||0)+" 个 ",1)]}),_:1}),n(b,{label:"变量"},{default:e(()=>{var s;return[u(c(((s=o(t).parseResult.variables)==null?void 0:s.length)||0)+" 个 ",1)]}),_:1}),n(b,{label:"宏定义"},{default:e(()=>{var s;return[u(c(((s=o(t).parseResult.macros)==null?void 0:s.length)||0)+" 个 ",1)]}),_:1})]),_:1}),n(F,null,{default:e(()=>[...l[4]||(l[4]=[u("结构体列表",-1)])]),_:1}),(f=o(t).parseResult.structs)!=null&&f.length?(i(),g(W,{key:0},{default:e(()=>[(i(!0),C(L,null,Q(o(t).parseResult.structs,s=>(i(),g(O,{key:s.name,header:s.name},{default:e(()=>[n(P,{columns:d,"data-source":s.fields,pagination:!1,size:"small"},null,8,["data-source"])]),_:2},1032,["header"]))),128))]),_:1})):(i(),g(E,{key:1,description:"暂无结构体"})),n(F,null,{default:e(()=>[...l[5]||(l[5]=[u("变量列表",-1)])]),_:1}),(y=o(t).parseResult.variables)!=null&&y.length?(i(),g(H,{key:2,size:"small","data-source":o(t).parseResult.variables},{renderItem:e(({item:s})=>[n(G,null,{default:e(()=>[n(j,null,{title:e(()=>[u(c(s.name),1)]),description:e(()=>[u(" 类型: "+c(s.structType)+" | 数量: "+c(s.count),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data-source"])):(i(),g(E,{key:3,description:"暂无变量"}))],64)):(i(),g(E,{key:1,description:"请先解析代码"}))]}),_:1})]),_:1})]),_:1}),n(V,{title:"问题列表",bordered:!1,style:{"margin-top":"16px"}},{extra:e(()=>[n(B,null,{default:e(()=>[n(R,{color:"red"},{default:e(()=>[u("错误: "+c(o(t).summary.errorCount),1)]),_:1}),n(R,{color:"orange"},{default:e(()=>[u("警告: "+c(o(t).summary.warningCount),1)]),_:1}),n(R,{color:"green"},{default:e(()=>[u("通过: "+c(o(t).summary.passCount),1)]),_:1})]),_:1})]),default:e(()=>[n(P,{columns:_,"data-source":o(t).problems,pagination:{pageSize:10},size:"small",onRowClick:A},{bodyCell:e(({column:f,record:y})=>[f.key==="resultType"?(i(),g(R,{key:0,color:I(y.resultType)},{default:e(()=>[u(c(y.resultType),1)]),_:2},1032,["color"])):z("",!0),f.key==="location"?(i(),C(L,{key:1},[y.location?(i(),C("span",ee," 第 "+c(y.location.startLine)+" 行 ",1)):z("",!0)],64)):z("",!0)]),_:1},8,["data-source"])]),_:1})])}}},se=J(ae,[["__scopeId","data-v-61ffa798"]]);export{se as default};
